<!DOCTYPE html>
<html style="width:100%; height:100%;">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Juelsminde Joust | miscellus.com</title>
</head>
<body style="width:100%; height:100%;">
    <input id="fullscreenButton" type=button value=fullscreen>
    <div id=statusElement></div>
    <div><progress hidden id=progressElement max=100 value=0></progress></div>
    <canvas style="width:100%; height:100%;" class="emscripten" id="canvasElement" oncontextmenu="event.preventDefault()"></canvas>
    <script src="files/juelsminde_joust.js"></script>
    <script>
        window.addEventListener("keydown", function(e) {
            if(["Space","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].indexOf(e.code) > -1) {
                e.preventDefault();
            }
        }, false);
        fullscreenButton.addEventListener('click', (ev) => {
          console.log('Fullscreen button clicked (listener).', ev);
          // run custom code before requestFullscreen is executed
          // if you want to prevent default fullscreen call and call manually:
          // ev.preventDefault();
          Module.requestFullscreen(true, true);
        }, {capture: true});
        canvasElement.addEventListener("webglcontextlost", (e => {
            alert("WebGL context lost. You will need to reload the page."), e.preventDefault()
        }), !1);
        var Module = Module || {};
        document.addEventListener("DOMContentLoaded", function(){
            Module.print = console.log;
            Module.canvas = canvasElement;
            Module.requestFullscreen = Browser.requestFullscreen;
            Module.setStatus = e => {
                if (Module.setStatus.last || (Module.setStatus.last = {
                        time: Date.now(),
                        text: ""
                    }), e !== Module.setStatus.last.text) {
                    var t = e.match(/([^(]+)\((\d+(\.\d+)?)\/(\d+)\)/),
                        s = Date.now();
                    t && s - Module.setStatus.last.time < 30 || (
                        Module.setStatus.last.time = s,
                        Module.setStatus.last.text = e,
                        t
                            ? (e = t[1], progressElement.value = 100 * parseInt(t[2]),
                                progressElement.max = 100 * parseInt(t[4]),
                                progressElement.hidden = false)
                            : (progressElement.value = null,
                                progressElement.max = null,
                                progressElement.hidden = true),
                            statusElement.innerHTML = e)
                }
            };
            Module.totalDependencies = 0;
            Module.monitorRunDependencies = e => {
                this.totalDependencies = Math.max(this.totalDependencies, e), Module.setStatus(e ? "Preparing... (" + (this.totalDependencies - e) + "/" + this.totalDependencies + ")" : "All downloads complete.")
            };
            Module.setStatus("Downloading...");
            window.onerror = e => {
                Module.setStatus("Exception thrown, see JavaScript console"), spinnerElement.style.display = "none", Module.setStatus = e => {
                    e && console.error("[post-exception status] " + e)
                }
            }
        });
    </script>
</body>
</html>